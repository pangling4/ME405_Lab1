<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ME 405: Lab 1: Lab 1: Gray Area</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ME 405: Lab 1
   </div>
   <div id="projectbrief">Motor and Encoder Reading</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Lab 1: Gray Area </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p >This exercise involved writing classes in order to run a motor and measure where it is by using an encoder. Without further ado, let's get spinning! </p>
<h1><a class="anchor" id="ss_Motor"></a>
Motor Control</h1>
<p >The motors used for this lab exercise utilize the L6206 H-bridge motor driver. It is used to control the 2 DC motors, controls the torque and the direction of the motor. It also acts as a safeguard so that the current does not short out the motor. The block diagram for this IC is shown below. <br  />
 </p><div class="image">
<img src="motor_control.JPG" alt=""/>
</div>
<p> The motor is connected to output pins OUT1A and OUT2A. The Nucleo L476-RG controls pins ENA, INA and IN2A. When controlling a single motor, the wires must be connected to the proper CPU pin and they are connected to a single timer on two seperate channels. The ENA pin must be enabled in order to enable the motor. The signals of INA and IN2A must be opposite of each other in order for the motor to spin. To reverse directions, the signals for each pin are reversed. The pin configuration with the appropriate timer and channels are given as such. The orange and the green wires were for the motor power. </p><div class="image">
<img src="pins_motors.jpg" alt=""/>
</div>
<p> The motor is driven by a MotorDriver class, which sets the velocity via pulse width modulation percentage. This is also known as a duty cycle. In this assignment, our main file uses the MotorDriver to spin the motor slowly until it has spun one full rotation, or 2 pi radians. </p>
<h1><a class="anchor" id="ss_Encoder"></a>
Encoder Reading</h1>
<p >The encoders were used to track the position of the motor as it was spinning. It measures the motor's rotations in units of ticks of the encoder. These encoders are quadrature optical encoders. The STM32 has timers that can read the pulses of the encoder in order to count distance and direction of motion. Gray code is used with two channels of the encoder. A timing diagram is shown below. The state of the encoder can be represented as (A,B). The encoder moving from (0,0) to (0,1) indicates that the motor is rotating counterclockwise, and a movement from (0,1) to (0,0) indicates that the motor is rotating clockwise. </p><div class="image">
<img src="enc_diag.jpg" alt=""/>
</div>
<p> The <a class="el" href="namespace_encoder_driver.html">EncoderDriver</a> works by measuring the delta, or difference, between the current reading and previous reading. This process is shown thanks to a drawing from ME 305 Lecturer Charlie Refvem. It is important to incorporate this technique to receive accurate readings. The encoder measures in ticks, but in order to make sense of it to measure the motors speed in revolutions per minute, the encoder reading must be converted. This is done by multiplying the nominal reading by the CPR value and the gear ratio of the motor since the encoder is directly attached to the motor. </p><div class="image">
<img src="charlie_encoder.jpg" alt=""/>
</div>
 <h1><a class="anchor" id="ss_main"></a>
Main Script</h1>
<p >The main script interfaces the MotorDriver and <a class="el" href="namespace_encoder_driver.html">EncoderDriver</a> together. We have not yet implemented a task algorithm, but the motor is simply set to a slow duty cycle and spins until it has gone one revolution, as the encoder reading reaches 2 pi radians. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
